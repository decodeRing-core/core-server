{{define "users"}}
<h2>User Management</h2>
{{range .Applications}}
<h3>{{.Name}}</h3>
<form action="/users/create" method="post">
    <input type="hidden" name="appId" value="{{.ID}}">
    <input type="text" name="userName" placeholder="New Username" required>
    <button type="submit">Create User</button>
</form>
<br>
{{if .Users}}
<table>
    <thead>
        <tr>
            <th>Username</th>
            <th>Status</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {{range .Users}}
        <tr>
            <td>{{.Name}}</td>
            <td>{{.Status}}</td>
            <td>
                <form action="/users/{{.ID}}/token" method="post" style="display: inline;">
                    <button type="submit">Get Token</button>
                </form>
                <form action="/users/{{.ID}}/suspend" method="post" style="display: inline;">
                    <button type="submit" {{if eq .Status "suspended"}}disabled{{end}}>Suspend</button>
                </form>
                <form action="/users/{{.ID}}/unsuspend" method="post" style="display: inline;">
                    <button type="submit" {{if ne .Status "suspended"}}disabled{{end}}>Unsuspend</button>
                </form>
                <form action="/users/{{.ID}}/delete" method="post" style="display: inline;">
                    <button type="submit" onclick="return confirm('Are you sure you want to delete this user?')">Delete</button>
                </form>
            </td>
        </tr>
        {{end}}
    </tbody>
</table>
{{else}}
<p>No users for this application.</p>
{{end}}
<hr>
{{end}}
{{end}}